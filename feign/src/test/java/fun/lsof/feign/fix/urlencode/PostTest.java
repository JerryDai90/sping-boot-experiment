package fun.lsof.feign.fix.urlencode;


import feign.FeignException;
import fun.lsof.feign.controller.InitiatorController;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

import java.util.HashMap;

import static org.springframework.test.util.AssertionErrors.assertEquals;
import static org.springframework.test.util.AssertionErrors.fail;

@RunWith(SpringRunner.class)
@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.DEFINED_PORT)
public class PostTest {

    @Autowired
    InitiatorController initiator;

    @Test
    public void fixPost2Get() {

        String _8kchar = "是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到" +
                "付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付" +
                "我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地" +
                "方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发" +
                "是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是" +
                "到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发是到付是到付收费的是到付我is对方了解杀戮都市老地方是发";


        try {
            initiator.get2query(_8kchar);
            fail("默认8K的头部大小已经修改，麻烦去掉", true, true);
        } catch (FeignException e) {

        }

        assertEquals("测试超过使用超过8K字符请求，如果使用POST就不会报错", _8kchar, initiator.post2form(_8kchar));

    }

}
